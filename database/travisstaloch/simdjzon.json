{
  "name": "simdjzon",
  "owner": "travisstaloch",
  "repo": "simdjzon",
  "description": "simdjson ported to zig",
  "type": "package",
  "topics": [
    "zig-package",
    "zig-library",
    "zig-lang"
  ],
  "stars": 131,
  "forks": 6,
  "watchers": 7,
  "updated_at": "2025-12-02T14:26:07Z",
  "readme": ":warning: **Work in progress.  Expect bugs and/or missing features** :warning:\n\n# simdjzon\nThis is a port of [simdjson](https://github.com/simdjson/simdjson), a high performance JSON parser developed by Daniel Lemire and Geoff Langdale to [zig](https://ziglang.org/).  \n\n# cpu support\nOnly 64 bit CPUs are supported so far.\n\n#### x86_64\nA CPU with AVX is required and CLMUL is preferred. the following usually have\nboth\n* Intel - Haswell from 2013 onwards\n* AMD - Ryzen/EPYC CPU (Q1 2017)\n\nThese commands show how to test for specific target and cpu support\n```console\nzig build test -Dtarget=x86_64-linux -Dcpu=x86_64+avx # uses clmulSoft - missing pclmul\nzig build test -Dtarget=x86_64-linux -Dcpu=x86_64+avx+pclmul\n# zig build test -Dtarget=x86_64-linux # doesn't work - missing avx\n# zig build test -Dcpu=x86_64_v2 # doesn't work - missing avx\n```\n\n#### aarch64\nA CPU with AES is preferred.\n```console\nzig build test -Dtarget=aarch64-linux -Dcpu=apple_latest-aes -fqemu # uses clmulSoft\nzig build test -Dtarget=aarch64-linux -fqemu\n```\n\n#### powerpc\nNot supported yet\n```console\n# zig build test -Dtarget=powerpc-linux -fqemu # doesn't work - no classify() + 32bit errors\n# zig build test -Dtarget=powerpc64-linux -fqemu # doesn't work - no classify()\n```\n\n#### fallback\nNo fallback for unsupported CPUs is provided yet.\n\n```console\n# zig build test -Dcpu=baseline # doesn't work - no classify()\n```\n\n# zig compiler support\nThe main branch is meant to compile with zig's master branch.  It is tested weekly on linux, windows and macos. \n\nFor older compiler versions, use a [tagged version](https://github.com/travisstaloch/simdjzon/tags).\n\n# usage\n### Git Clone\n```console\n# json validation\n$ git clone https://github.com/travisstaloch/simdjzon\n$ cd simdjzon\n$ zig build -Drelease-fast # uses the dom api by default\n$ zig-out/bin/simdjzon test/test.json\n$ echo $? # 0 on success\n0\n$ zig build -Drelease-fast -Dondemand # use the ondemand api\n$ zig-out/bin/simdjzon test/test.json\n$ echo $? # 0 on success\n0\n$ zig build test\nAll 19 tests passed.\n```\n\n### Zig Package\n```console\n$ $ zig fetch --save git+https://github.com/travisstaloch/simdjzon\ninfo: resolved to commit 28d46c979f761b211539232378138b692ef50d55\n```\n```zig\n// build.zig\nconst simdjzon_dep = b.dependency(\"simdjzon\", .{ .target = target, .optimize = optimize });\nconst exe_mod = b.createModule(.{\n    // ...\n    .imports = &.{\n        .{ .name = \"simdjzon\", .module = simdjzon_dep.module(\"simdjzon\") },\n    },\n});\n```\n```zig\n// main.zig\nconst simdjzon = @import(\"simdjzon\");\n```\n#### dom API\n```zig\n// const dom = @import(\"simdjzon\").dom;\ntest \"get with struct - readme\" {\n    const S = struct { a: u8, b: []const u8, c: struct { d: u8 } };\n    const input =\n        \\\\{\"a\": 42, \"b\": \"b-string\", \"c\": {\"d\": 126}}\n    ;\n    var parser = try dom.Parser.initFixedBuffer(allr, input, .{});\n    defer parser.deinit();\n    try parser.parse();\n    var s: S = undefined;\n    try parser.element().get(&s);\n    try testing.expectEqual(@as(u8, 42), s.a);\n    try testing.expectEqualStrings(\"b-string\", s.b);\n    try testing.expectEqual(@as(u8, 126), s.c.d);\n}\n\ntest \"at_pointer - readme\" {\n    const input =\n        \\\\{\"a\": {\"b\": [1,2,3]}}\n    ;\n    var parser = try dom.Parser.initFixedBuffer(allr, input, .{});\n    defer parser.deinit();\n    try parser.parse();\n    const b0 = try parser.element().at_pointer(\"/a/b/0\");\n    try testing.expectEqual(@as(i64, 1), try b0.get_int64());\n}\n```\n#### ondemand API\n:warning: ondemand get_string() seems to have bugs when building in release small modes. :warning:\n```zig\n// const ondemand = @import(\"simdjzon\").ondemand;\n// ondemand api users must specify `pub const read_buf_cap = N;` in their\n// root source file.  In tests, this defaults to `std.mem.page_size`.\ntest \"ondemand get with struct - readme\" {\n    const S = struct { a: struct { b: []const u8 } };\n    const input =\n        \\\\{\"a\": {\"b\": \"b-string\"}}\n    ;\n    // ondemand api requires a seekable file.\n    // --- begin boilerplate ceremony.  this can usually be replaced with just opening a file\n    const file_name = \"ondemand_get_with_struct_readme\";\n    var tdir = testing.tmpDir(.{});\n    defer tdir.cleanup();\n    const tfile = try tdir.dir.createFile(file_name, .{ .read = true });\n    defer tfile.close();\n    try tfile.writeAll(input);\n    try tfile.seekTo(0);\n    // --- end boilerplate ceremony.\n    var read_buf: [READ_BUF_CAP]u8 = undefined;\n    var src = tfile.reader(&read_buf);\n    var parser = try ondemand.Parser.init(&src, allr, file_name, .{});\n    defer parser.deinit();\n    var doc = try parser.iterate();\n\n    var s: S = undefined;\n    try doc.get(&s, .{ .allocator = allr });\n    defer allr.free(s.a.b);\n    try testing.expectEqualStrings(\"b-string\", s.a.b);\n}\n\ntest \"ondemand at_pointer - readme\" {\n    const input =\n        \\\\{\"a\": {\"b\": [1,2,3]}}\n    ;\n    // ondemand api requires a seekable file.\n    // --- begin boilerplate ceremony.  this can usually be replaced with just opening a file\n    const file_name = \"ondemand_at_pointer_readme\";\n    var tdir = testing.tmpDir(.{});\n    defer tdir.cleanup();\n    const tfile = try tdir.dir.createFile(file_name, .{ .read = true });\n    defer tfile.close();\n    try tfile.writeAll(input);\n    try tfile.seekTo(0);\n    // --- end boilerplate ceremony.\n    var read_buf: [READ_BUF_CAP]u8 = undefined;\n    var src = tfile.reader(&read_buf);\n    var parser = try ondemand.Parser.init(&src, allr, file_name, .{});\n    defer parser.deinit();\n    var doc = try parser.iterate();\n    var b0 = try doc.at_pointer(\"/a/b/0\");\n    try testing.expectEqual(@as(u8, 1), try b0.get_int(u8));\n}\n```\n\n# performance\n## parsing/validating twitter.json (630Kb)\n### simdjson\n\n### benchmark vs simdjson - 8/25/25\n```console\n$ cd zig-out/bin/\n$ wget https://raw.githubusercontent.com/simdjson/simdjson/master/singleheader/simdjson.h https://raw.githubus\nercontent.com/simdjson/simdjson/master/singleheader/simdjson.cpp https://raw.githubusercontent.com/simdjson/simdjson/master/jsonexampl\nes/twitter.json\n# ...\n\n$ cat > main.cpp\n#include \"simdjson.h\"\nusing namespace simdjson;\nint main(int argc, char** argv) {\n    if(argc != 2) {\n        std::cout << \"USAGE: ./simdjson <file.json>\" << std::endl;\n        exit(1);\n    }\n    dom::parser parser;\n    try\n    {\n        const dom::element doc = parser.load(argv[1]);\n    }\n    catch(const std::exception& e)\n    {\n        std::cerr << e.what() << '\\n';\n        return 1;\n    }\n    return 0;\n}\n$ g++ main.cpp simdjson.cpp -o simdjson -O3 -march=native\n$ cd ../..\n$ poop 'zig-out/bin/simdjson zig-out/bin/twitter.json' 'zig-out/bin/simdjzon zig-out/bin/twitter.json'\nBenchmark 1 (2052 runs): zig-out/bin/simdjson zig-out/bin/twitter.json\n  measurement          mean ± σ            min … max           outliers         delta\n  wall_time          2.39ms ±  162us    1.84ms … 3.22ms         45 ( 2%)        0%\n  peak_rss           5.13MB ± 80.8KB    4.76MB … 5.37MB         12 ( 1%)        0%\n  cpu_cycles         2.35M  ± 97.3K     2.25M  … 3.64M         189 ( 9%)        0%\n  instructions       5.27M  ± 4.22      5.27M  … 5.27M          93 ( 5%)        0%\n  cache_references    151K  ± 4.36K      134K  …  217K         195 (10%)        0%\n  cache_misses       24.3K  ± 1.45K     19.2K  … 31.4K          78 ( 4%)        0%\n  branch_misses      21.1K  ±  675      18.9K  … 23.0K           3 ( 0%)        0%\nBenchmark 2 (3093 runs): zig-out/bin/simdjzon zig-out/bin/twitter.json\n  measurement          mean ± σ            min … max           outliers         delta\n  wall_time          1.58ms ±  128us    1.17ms … 2.16ms         56 ( 2%)        ⚡- 34.0% ±  0.3%\n  peak_rss           1.54MB ± 57.6KB    1.31MB … 1.57MB        764 (25%)        ⚡- 70.0% ±  0.1%\n  cpu_cycles         1.64M  ± 86.6K     1.56M  … 2.43M         369 (12%)        ⚡- 30.2% ±  0.2%\n  instructions       4.53M  ± 0.81      4.53M  … 4.53M         107 ( 3%)        ⚡- 14.1% ±  0.0%\n  cache_references   80.3K  ± 1.62K     72.8K  …  109K         155 ( 5%)        ⚡- 46.8% ±  0.1%\n  cache_misses       2.60K  ±  894      1.36K  … 7.94K          58 ( 2%)        ⚡- 89.3% ±  0.3%\n  branch_misses      5.14K  ±  655      3.38K  … 7.68K          20 ( 1%)        ⚡- 75.6% ±  0.2%\n```\n\n### timed against simdjson, go, nim, zig std lib\nThe simdjson binary was compiled as shown above.  Go and nim binaries created with sources from JSONTestSuite. [zig std lib driver](bench/src/zig_json.zig).\nValidation times for several large json files.  Created with [benchmark_and_plot.jl](bench/benchmark_and_plot.jl)\n\n![results](https://github.com/travisstaloch/simdjson-zig/blob/media/bench/validation_grouped.png)\n\n# JSONTestSuite\n\nResults of running simdjson and simdjzon through [JSONTestSuite](https://github.com/nst/JSONTestSuite).  Results are equal as of 8/7/21\n\n![results](https://github.com/travisstaloch/simdjson-zig/blob/media/JSONTestSuiteResults.png)\n\n",
  "owner_avatar_url": "https://avatars.githubusercontent.com/u/1562827?v=4",
  "releases": [],
  "owner_company": null,
  "owner_location": null,
  "owner_blog": null,
  "owner_twitter_username": null,
  "owner_followers": 68,
  "owner_following": 32,
  "owner_created_at": "2012-03-22T00:22:23Z",
  "category": "library"
}