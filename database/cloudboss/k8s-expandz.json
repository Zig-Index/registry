{
  "name": "k8s-expandz",
  "owner": "cloudboss",
  "repo": "k8s-expandz",
  "description": "",
  "type": "package",
  "topics": [
    "kubernetes",
    "zig",
    "zig-package"
  ],
  "stars": 0,
  "forks": 0,
  "watchers": 0,
  "updated_at": "2026-01-27T05:49:39Z",
  "minimum_zig_version": "0.15.2",
  "readme": "# k8s-expand\n\nA Zig library to expand variables in the style of Kubernetes pod manifests.\n\nThis is a port from Kubernetes under `third_party/forked/golang/expansion`, which is forked from Go (hence the Go license).\n\n## Overview\n\nKubernetes uses the `$(VAR_NAME)` syntax for variable expansion in pod specifications. This library provides the same expansion functionality for use in Zig applications.\n\n## Features\n\n- Expands `$(VAR_NAME)` variable references\n- Supports escape sequences: `$$` becomes a literal `$`\n- Preserves undefined variables: `$(UNDEFINED)` stays as-is\n- Ignores shell syntax: `${VAR}` passes through unchanged\n- Supports multiple lookup contexts (searched in order)\n\n## Installation\n\n```bash\nzig fetch --save git+https://github.com/cloudboss/k8s-expandz\n```\n\nThen in your `build.zig`:\n\n```zig\nconst k8s_expand = b.dependency(\"k8s_expand\", .{\n    .target = target,\n    .optimize = optimize,\n});\nexe.root_module.addImport(\"k8s_expand\", k8s_expand.module(\"k8s_expand\"));\n```\n\n## Usage\n\n```zig\nconst std = @import(\"std\");\nconst k8s_expand = @import(\"k8s_expand\");\n\npub fn main() !void {\n    var gpa = std.heap.GeneralPurposeAllocator(.{}){};\n    defer _ = gpa.deinit();\n    const allocator = gpa.allocator();\n\n    // Create a variable map\n    var env = std.StringHashMap([]const u8).init(allocator);\n    defer env.deinit();\n    try env.put(\"GREETING\", \"Hello\");\n    try env.put(\"NAME\", \"World\");\n\n    // Create context (array of map pointers)\n    const context = [_]*const std.StringHashMap([]const u8){&env};\n\n    // Expand variables\n    const result = try k8s_expand.expand(allocator, \"$(GREETING), $(NAME)!\", &context);\n    defer allocator.free(result);\n\n    std.debug.print(\"{s}\\n\", .{result}); // Output: Hello, World!\n}\n```\n\n## API\n\n### `expand`\n\n```zig\npub fn expand(\n    allocator: Allocator,\n    input: []const u8,\n    context: Context,\n) ![]u8\n```\n\nExpands all `$(VAR_NAME)` references in the input string. The returned string is allocated and must be freed by the caller.\n\n### `expandMaybeAlloc`\n\n```zig\npub fn expandMaybeAlloc(\n    allocator: Allocator,\n    input: []const u8,\n    context: Context,\n) ![]const u8\n```\n\nOptimized version that returns the original input if no expansion is needed. Check if `result.ptr != input.ptr` to determine if the result needs to be freed.\n\n### `lookup`\n\n```zig\npub fn lookup(context: Context, name: []const u8) ?[]const u8\n```\n\nLooks up a variable name in the context maps. Returns the value if found, or `null` if not found.\n\n### `syntaxWrap`\n\n```zig\npub fn syntaxWrap(allocator: Allocator, input: []const u8) ![]u8\n```\n\nWraps a variable name in the expansion syntax: `\"FOO\"` becomes `\"$(FOO)\"`.\n\n## Expansion Rules\n\n| Input | Output | Description |\n|-------|--------|-------------|\n| `$(VAR)` | `value` | Variable expansion (if VAR is defined) |\n| `$(VAR)` | `$(VAR)` | Preserved (if VAR is undefined) |\n| `$$` | `$` | Escaped dollar sign |\n| `$VAR` | `$VAR` | Bare variable (no parentheses) - passed through |\n| `${VAR}` | `${VAR}` | Shell syntax - passed through |\n| `$(unclosed` | `$(unclosed` | Unterminated - passed through |\n\n## Multiple Contexts\n\nYou can provide multiple variable maps. They are searched in order, with the first match winning:\n\n```zig\nvar env1 = std.StringHashMap([]const u8).init(allocator);\ntry env1.put(\"VAR\", \"from-env1\");\n\nvar env2 = std.StringHashMap([]const u8).init(allocator);\ntry env2.put(\"VAR\", \"from-env2\");\ntry env2.put(\"OTHER\", \"only-in-env2\");\n\nconst context = [_]*const std.StringHashMap([]const u8){ &env1, &env2 };\n\n// $(VAR) -> \"from-env1\" (first context wins)\n// $(OTHER) -> \"only-in-env2\" (found in second context)\n```\n\n## Building\n\n```bash\nzig build        # Build the library\nzig build test   # Run tests\n```\n\n## License\n\nSame license as the original [k8s-expand](https://github.com/cloudboss/k8s-expand) library.\n",
  "owner_avatar_url": "https://avatars.githubusercontent.com/u/15853060?v=4",
  "releases": [],
  "owner_bio": null,
  "owner_location": null,
  "owner_blog": null,
  "owner_twitter_username": null,
  "owner_created_at": "2015-11-15T03:30:33Z",
  "license": "BSD-3-Clause",
  "category": "library"
}