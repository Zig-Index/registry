{
  "name": "verilator",
  "owner": "thuvasooriya",
  "repo": "verilator",
  "description": "build verilator with zig",
  "type": "package",
  "topics": [
    "compilers",
    "cpp",
    "rtl",
    "system-verilog",
    "systemc",
    "verilator",
    "verilog",
    "verilog-simulator",
    "zig",
    "zig-package"
  ],
  "stars": 1,
  "forks": 0,
  "watchers": 0,
  "updated_at": "2025-11-25T09:15:03Z",
  "dependencies": [
    {
      "name": "verilator",
      "url": "git+https://github.com/verilator/verilator#b4d064d1669cc2a8d921eae64f88f4586042c825",
      "hash": "N-V-__8AAIR16AajpwHhnr7EeBBEoPp5715hoc4T8HrA5_Vi"
    }
  ],
  "minimum_zig_version": "0.15.1",
  "readme": "# Verilator Zig Build\n\n## Quick Start\n\n```bash\nzig build -Doptimize=ReleaseFast\n\n./zig-out/bin/verilator --version\n./zig-out/bin/verilator --help\n./zig-out/bin/verilator --lint-only your_design.v\n\n./zig-out/bin/verilator_coverage --help\n```\n\n## Requirements\n\n**Build-time:**\n\n- Zig 0.15.1+\n- Python 3\n- Bison 2.3+\n- Flex 2.5.4+\n\n**Runtime:**\n\n- Perl (for wrapper script)\n- C++ standard library\n\n## Build Process\n\nThe build system automatically:\n\n1. **Generates config headers** (`generate.zig`)\n   - `config_package.h` - Package metadata\n   - `config_rev.h` - Git version from upstream dependency URL\n\n2. **Runs Bison** (generates parser from upstream)\n   - `verilog.y` → `V3ParseBison.c`, `V3ParseBison.h`\n   - Used via `#include` by `V3ParseGrammar.cpp` (unity build)\n\n3. **Runs Flex** (generates lexers from upstream)\n   - `verilog.l` → `V3Lexer.yy.cpp` (included by `V3ParseLex.cpp`)\n   - `V3PreLex.l` → `V3PreLex.yy.cpp` (included by `V3PreProc.cpp`)\n   - Post-processed with `flexfix_wrapper.py` (uses upstream flexfix)\n\n4. **Runs Astgen** (generates AST code from upstream)\n   - Creates 24 header files (`V3Ast__gen_*.h`, `V3Dfg__gen_*.h`)\n   - Creates `V3Const__gen.cpp` (compiled separately)\n   - Uses `astgen_wrapper.py` to invoke upstream astgen script\n\n5. **Compiles everything**\n   - 153 upstream C++ files\n   - 1 generated C++ file (`V3Const__gen.cpp`)\n   - Links with libc++\n\n6. **Installs**\n   - `bin/verilator` - Perl wrapper\n   - `bin/verilator_bin` - Compiled binary\n   - `bin/verilator_coverage` - Perl wrapper\n   - `bin/verilator_coverage_bin_dbg` - Coverage binary\n   - `include/` - Runtime support files\n\n## Project Structure\n\n```\n.\n├── build.zig              # Main build system\n├── generate.zig           # Config header generation library\n├── build.zig.zon          # Verilator source dependency\n├── astgen_wrapper.py      # Wrapper for upstream astgen\n├── flexfix_wrapper.py     # Wrapper for upstream flexfix\n└── include/\n    └── FlexLexer.h        # Local flex header\n```\n\n## Unity Build Pattern\n\nVerilator uses \"unity builds\" where some generated files are `#include`d rather than compiled separately.\n\nThis allows wrapper code to access internal bison/flex symbols:\n\n- `V3ParseBison.c` → included by `V3ParseGrammar.cpp`\n- `V3Lexer.yy.cpp` → included by `V3ParseLex.cpp`\n- `V3PreLex.yy.cpp` → included by `V3PreProc.cpp`\n\n**Exception**: `V3Const__gen.cpp` is compiled as a separate object.\n\n## Build Outputs\n\n| Metric             | Debug    | ReleaseFast |\n| ------------------ | -------- | ----------- |\n| verilator_bin      | 145 MB   | ~15 MB      |\n| verilator_coverage | 3.9 MB   | ~800 KB     |\n| Build Time         | ~2-3 min | ~5-10 min   |\n\n## Testing\n\n```bash\n# Version check\n$ ./zig-out/bin/verilator --version\nVerilator 5.41.0 rev b4d064d\n\n# Coverage tool\n$ ./zig-out/bin/verilator_coverage --version\nVerilator 5.41.0 rev b4d064d\n```\n\n## Updating Verilator Version\n\nEdit `build.zig.zon`:\n\n```zig\n.verilator = .{\n    .url = \"https://github.com/verilator/verilator/archive/<commit>.tar.gz\",\n    .hash = \"...\", // Run zig build to get the hash\n},\n```\n\nThen run `zig build` and fix any compilation errors from API changes.\n\n## Implementation Notes\n\n- All generation commands use upstream Verilator sources via wrappers\n- Config files generated from `build.zig.zon` dependency URL\n- Generated files written to `.zig-cache`\n- Unity build pattern: some generated files are `#include`d instead of compiled separately\n- Coverage tool (`VlcMain.cpp`) is a simple unity build with no generation dependencies\n\n## License\n\nVerilator is licensed under LGPL-3.0-only OR Artistic-2.0.\nThis follows the same terms.\n",
  "owner_avatar_url": "https://avatars.githubusercontent.com/u/74165167?u=6f4c3b1ba878d99ea2139feb0c1f1b0403c7dd94&v=4",
  "releases": [],
  "owner_bio": "reading electronics and telecom engineering @ university of moratuwa w/ chips, robots, n automation",
  "owner_company": null,
  "owner_location": "Sri Lanka",
  "owner_blog": "thuvasooriya.me",
  "owner_twitter_username": "thuvasooriya",
  "owner_followers": 25,
  "owner_following": 71,
  "owner_created_at": "2020-11-09T02:58:29Z",
  "license": "LGPL-3.0",
  "category": "library"
}