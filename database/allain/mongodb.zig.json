{
  "name": "mongodb.zig",
  "owner": "allain",
  "repo": "mongodb.zig",
  "description": "MongoDb driver for zig that uses zig 0.16 io",
  "type": "package",
  "topics": [
    "zig-package"
  ],
  "stars": 0,
  "forks": 0,
  "watchers": 0,
  "updated_at": "2026-03-01T17:11:37Z",
  "minimum_zig_version": "0.16.0",
  "readme": "# mongodb\n\nA native MongoDB client library for Zig. Connects over the MongoDB wire protocol with SCRAM-SHA-256 authentication, BSON encoding/decoding, and cursor-based iteration.\n\n## Features\n\n- CRUD operations: `findOne`, `find`, `insertMany`, `replaceOne`, `deleteOne`, `findOneAndDelete`\n- Aggregation pipelines\n- Index creation\n- SCRAM-SHA-256 authentication\n- Automatic cursor iteration with `getMore`\n- BSON encoding and decoding via `std.json.ObjectMap`\n- Configurable connection retries with exponential backoff\n\n## Requirements\n\n- Zig 0.16.0-dev or later\n- A running MongoDB instance\n\n## Installation\n\nFetch the package:\n\n```sh\nzig fetch --save git+https://codeberg.org/allain/mongodb.zig\n```\n\nThen add it to your `build.zig`:\n\n```zig\nconst mongodb_dep = b.dependency(\"mongodb\", .{\n    .target = target,\n    .optimize = optimize,\n});\nexe.root_module.addImport(\"mongodb\", mongodb_dep.module(\"mongodb\"));\n```\n\n## Usage\n\n```zig\nconst std = @import(\"std\");\nconst mongodb = @import(\"mongodb\");\n\npub fn main() !void {\n    const allocator = std.heap.page_allocator;\n\n    // Set up I/O\n    const threaded = try allocator.create(std.Io.Threaded);\n    threaded.* = std.Io.Threaded.init(allocator, .{});\n    const io = threaded.io();\n\n    // Connect\n    const uri = try mongodb.parseUri(\"mongodb://user:pass@localhost:27017/mydb?authSource=admin\");\n    const conn = try allocator.create(mongodb.Connection);\n    conn.* = try mongodb.Connection.connect(allocator, io, uri, .{});\n    defer conn.close();\n\n    // Create client\n    var client = mongodb.Client.init(allocator, conn);\n\n    // Insert\n    var doc = std.json.ObjectMap.init(allocator);\n    defer doc.deinit();\n    try doc.put(\"name\", .{ .string = \"alice\" });\n    try doc.put(\"age\", .{ .integer = 30 });\n    try client.insertMany(allocator, \"users\", &.{doc});\n\n    // Find\n    var filter = std.json.ObjectMap.init(allocator);\n    defer filter.deinit();\n    try filter.put(\"name\", .{ .string = \"alice\" });\n\n    if (try client.findOne(allocator, \"users\", filter)) |*found| {\n        defer mongodb.bson.freeObjectMap(allocator, @constCast(found));\n        // Use found document...\n    }\n}\n```\n\n## API\n\n### Connection\n\n```zig\nconst uri = try mongodb.parseUri(\"mongodb://user:pass@localhost:27017/mydb\");\nconn.* = try mongodb.Connection.connect(allocator, io, uri, .{});\nconn.* = try mongodb.Connection.connect(allocator, io, uri, .{\n    .max_retries = 10,\n    .retry_delay_ms = 1000,\n    .backoff_ratio = 2,\n});\n```\n\n### Client Operations\n\n| Method | Description |\n|--------|-------------|\n| `findOne(allocator, collection, filter)` | Find a single matching document |\n| `find(allocator, collection, filter, opts)` | Find multiple documents with sort/limit/skip/projection |\n| `insertMany(allocator, collection, docs)` | Insert one or more documents |\n| `replaceOne(allocator, collection, filter, replacement, upsert)` | Replace a document |\n| `deleteOne(allocator, collection, filter)` | Delete a single document |\n| `findOneAndDelete(allocator, collection, filter)` | Atomically find and delete a document |\n| `aggregate(allocator, collection, pipeline)` | Run an aggregation pipeline |\n| `createIndex(allocator, collection, keys, name)` | Create an index |\n\n### BSON\n\nDocuments use `std.json.ObjectMap` and `std.json.Value`. The `bson` namespace provides encoding, decoding, and memory management:\n\n```zig\n// Encode an ObjectMap to BSON bytes\nconst bytes = try mongodb.bson.encode(allocator, doc);\ndefer allocator.free(bytes);\n\n// Decode BSON bytes back to an ObjectMap\nvar decoded = try mongodb.bson.decode(allocator, bytes);\ndefer mongodb.bson.freeObjectMap(allocator, &decoded);\n```\n\n## Testing\n\nRun unit tests (no MongoDB required):\n\n```sh\nzig build test\n```\n\nRun integration tests (requires Docker):\n\n```sh\nzig build integration-test\n```\n\nRun tests with coverage (requires Docker and kcov):\n\n```sh\nzig build coverage\n```\n\n## License\n\nMIT\n",
  "owner_avatar_url": "https://avatars.githubusercontent.com/u/112751?u=07104c9e00aa658892a8cea55b5e0ee118a3d667&v=4",
  "releases": [],
  "owner_bio": "Senior Developer at Elastalink",
  "owner_company": "Elastalink",
  "owner_location": "Ottawa, ON",
  "owner_blog": "http://stackoverflow.com/users/2443/allain-lalonde",
  "owner_twitter_username": "allain",
  "owner_followers": 61,
  "owner_following": 89,
  "owner_created_at": "2009-08-07T01:54:53Z",
  "category": "library"
}