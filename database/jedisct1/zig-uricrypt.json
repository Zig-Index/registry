{
  "name": "zig-uricrypt",
  "owner": "jedisct1",
  "repo": "zig-uricrypt",
  "description": "Prefix-preserving, deterministic encryption for URIs.",
  "type": "package",
  "topics": [
    "encryption",
    "uri",
    "url",
    "zig-package",
    "ziglang",
    "prefix-preserving"
  ],
  "stars": 4,
  "forks": 0,
  "watchers": 1,
  "updated_at": "2025-09-26T09:40:00Z",
  "dependencies": [
    {
      "name": "example",
      "url": "https://example.com/foo.tar.gz",
      "hash": "..."
    }
  ],
  "minimum_zig_version": "0.15.1",
  "readme": "# zig-uricrypt\n\nA Zig library and CLI tool for prefix-preserving, deterministic URI encryption that maintains path hierarchy in encrypted form.\n\n## Purpose\n\nThis library provides privacy-preserving URI encryption where URIs sharing the same prefix components produce ciphertexts with common prefixes. This property:\n\n- Preserves Path Hierarchy: Encrypted URIs maintain the same structural relationships as their plaintext counterparts\n- Enables Privacy-Preserving Analysis: Allows operations like prefix matching, range queries, and hierarchical data analysis without decrypting the URIs\n- Maintains Determinism: Same input URI always produces the same encrypted output\n\nThis is particularly useful for applications that need to:\n\n- Store encrypted URIs while preserving their hierarchical relationships\n- Perform analytics on encrypted URI patterns\n- Implement access controls based on URI prefixes\n- Migrate sensitive URIs to encrypted storage without losing structural information\n\n## API Reference\n\n### `encryptUri(allocator, uri, secret_key, context) ![]u8`\n\nEncrypts a URI using the provided secret key and context.\n\n- `allocator`: Memory allocator for the encrypted output\n- `uri`: URI to encrypt (e.g., `\"https://example.com/path\"` or `\"/path/to/file\"`)\n- `secret_key`: Secret key for encryption (any string)\n- `context`: Context string for domain separation\n\nReturns encrypted URI as allocated slice. Caller must free the result.\n\n### `decryptUri(allocator, encrypted_uri, secret_key, context) ![]u8`\n\nDecrypts a previously encrypted URI.\n\n- `allocator`: Memory allocator for the decrypted output\n- `encrypted_uri`: Encrypted URI from `encryptUri`\n- `secret_key`: Same secret key used for encryption\n- `context`: Same context used for encryption\n\nReturns original URI as allocated slice. Caller must free the result.\n\n## How It Works\n\n1. URI Parsing: Splits URI into scheme and path components\n2. Key Derivation: Uses TurboShake128 to derive cryptographic material from key + context\n3. Component Processing: For each URI component:\n   - Generate a unique SIV using the component data\n   - Generate keystream from key + context + SIV\n   - XOR the component with the keystream\n   - Apply padding for base64 compatibility\n4. Encoding: Concatenate SIVs and encrypted components, encode as base64\n5. Scheme Handling: Preserves original scheme or adds `/` prefix for path-only URIs\n\n## Prefix Preservation Example\n\nGiven these related URIs:\n```\nhttps://api.example.com/v1/users\nhttps://api.example.com/v1/users/123\nhttps://api.example.com/v1/users/123/profile\n```\n\nTheir encrypted forms will share common prefixes:\n```\nYWJjZGVmZ2hpams=\nYWJjZGVmZ2hpams=bG1ub3BxcnN0dXY=\nYWJjZGVmZ2hpams=bG1ub3BxcnN0dXY=eHl6MDEyMzQ1Njc4OQ==\n```\n\nThis allows you to:\n- Find all encrypted URIs under `/v1/users/` without decryption\n- Implement hierarchical access controls on encrypted data\n- Perform analytics on URI patterns while preserving privacy\n\n## Security Notes\n\n- The encryption is deterministic - same inputs always produce same outputs\n- Each component has its own SIV for authentication\n- Wrong key or context will cause decryption to fail\n- Uses TurboShake128 (SHA3 variant) for all cryptographic operations\n\n## Examples\n\n### Basic URI Encryption\n```zig\nconst encrypted = try uricrypt.encryptUri(\n    allocator,\n    \"https://api.example.com/v1/users/123\",\n    \"api_key_123\",\n    \"production\"\n);\n```\n\n### Path-only URI\n```zig\nconst encrypted = try uricrypt.encryptUri(\n    allocator,\n    \"/uploads/2024/documents/report.pdf\",\n    \"file_storage_key\",\n    \"user_uploads\"\n);\n```\n",
  "owner_avatar_url": "https://avatars.githubusercontent.com/u/124872?v=4",
  "releases": [],
  "owner_bio": "Get my public keys here: https://sk.tl/7CPRo8kn",
  "owner_company": null,
  "owner_location": "Antibes, France",
  "owner_blog": "https://00f.net",
  "owner_twitter_username": "jedisct1",
  "owner_followers": 4136,
  "owner_following": 195,
  "owner_created_at": "2009-09-09T10:20:57Z",
  "license": "BSD-2-Clause",
  "category": "library"
}