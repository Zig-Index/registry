{
  "name": "zig-xet",
  "owner": "jedisct1",
  "repo": "zig-xet",
  "description": "Implementation of the HuggingFace Xet Protocol.",
  "type": "package",
  "topics": [
    "hf",
    "huggingface",
    "protocol",
    "xet",
    "zig",
    "zig-package",
    "face",
    "hugging",
    "xorb"
  ],
  "stars": 19,
  "forks": 2,
  "watchers": 1,
  "updated_at": "2026-01-25T08:23:22Z",
  "dependencies": [
    {
      "name": "lz4",
      "url": "https://github.com/jedisct1/zig-lz4/archive/refs/tags/0.1.1.tar.gz",
      "hash": "lz4-0.1.0-fUqx0aNqAwAgCD6q9krWFpMsUwLWZ-NRuuTxmHMOaxoV"
    },
    {
      "name": "ultracdc",
      "url": "https://github.com/jedisct1/zig-ultracdc/archive/refs/tags/0.1.1.tar.gz",
      "hash": "ultracdc-0.1.0-vd07qbV2AAAUDCBiDEKMMVAZ7QUMgmjennH-W2KCIVck"
    }
  ],
  "minimum_zig_version": "0.16.0-dev.929+b409cdf63",
  "readme": "# zig-xet\n\n<p align=\"center\">\n  <img src=\".media/logo.jpg\" />\n</p>\n\nA pure Zig implementation of the XET protocol for efficient file storage and retrieval through content-defined chunking and deduplication.\n\n## What is this?\n\nXET is a protocol for handling large files by breaking them into chunks based on their content (not fixed sizes), compressing them, and storing them in a way that eliminates duplicates.\n\nIt's particularly useful for managing large models and datasets, like those hosted on HuggingFace.\n\nThis library implements the full XET protocol spec in Zig, including:\n\n- Content-defined chunking using the Gearhash algorithm (chunks are between 8KB-128KB)\n- LZ4 compression with byte grouping optimization and experimental bit grouping\n- Merkle tree construction for efficient file verification\n- Xorb format for serializing chunked data\n- MDB shard format for metadata storage\n- CAS client for downloading files from HuggingFace\n- Parallel chunk fetching, decompression, and hashing using thread pools\n\nThe implementation has been cross-verified against the Rust reference implementation to ensure correctness.\n\nIt can be compiled to WebAssembly, but runs at about 45% of the non-threaded native speed.\n\n## Quick start\n\n### Requirements\n\n- Zig 0.16 or newer\n- A HuggingFace token (for downloading models)\n\n### Build and test\n\n```bash\n# Build the project\nzig build\n\n# Run tests (98 tests covering all components)\nzig build test\n\n# Run the demo CLI\nzig build run\n\n# Run benchmarks\nzig build bench\n```\n\n### Downloading a model from HuggingFace\n\nThe most common use case is downloading models efficiently:\n\n```bash\n# Set your HuggingFace token\nexport HF_TOKEN=\"your_token_here\"\n\n# Run the download example (sequential)\nzig build run-example-download\n\n# Run the parallel download example (faster for large files)\nzig build run-example-parallel\n```\n\nThe parallel version uses multiple threads to fetch, decompress, and hash chunks simultaneously, providing significant performance improvements for large models.\n\n### Using as a library\n\nAdd to your `build.zig.zon`:\n\n```zig\n.dependencies = .{\n    .xet = .{\n        .url = \"https://github.com/yourusername/zig-xet/archive/main.tar.gz\",\n    },\n},\n```\n\nThen in your code:\n\n```zig\nconst std = @import(\"std\");\nconst xet = @import(\"xet\");\n\n// Chunk a file using content-defined chunking\nvar chunks = try xet.chunking.chunkBuffer(allocator, data);\ndefer chunks.deinit(allocator);\n\n// Hash chunks with BLAKE3\nconst hash = xet.hashing.computeDataHash(chunk_data);\n\n// Build a Merkle tree for verification\nconst merkle_root = try xet.hashing.buildMerkleTree(allocator, &nodes);\n\n// Download a model from HuggingFace (sequential)\nvar io_instance = std.Io.Threaded.init(allocator);\ndefer io_instance.deinit();\nconst io = io_instance.io();\n\nconst config = xet.model_download.DownloadConfig{\n    .repo_id = \"org/model\",\n    .repo_type = \"model\",\n    .revision = \"main\",\n    .file_hash_hex = \"...\",\n};\ntry xet.model_download.downloadModelToFile(allocator, io, config, \"output.gguf\");\n\n// Or download with parallel fetching (faster for large files)\ntry xet.model_download.downloadModelToFileParallel(\n    allocator,\n    io,\n    config,\n    \"output.gguf\",\n    false, // Don't compute hashes during download\n);\n```\n\n## How it works\n\nThe XET protocol processes files in several stages:\n\n1. Chunking: Files are split using a rolling hash algorithm. Instead of fixed-size chunks, boundaries are determined by content patterns, which means similar files share many identical chunks.\n\n2. Hashing: Each chunk gets a BLAKE3 hash. A Merkle tree combines these hashes to create a single file identifier.\n\n3. Compression: Chunks are compressed with LZ4, optionally with byte grouping preprocessing for better ratios.\n\n4. Deduplication: Identical chunks (same hash) are stored only once, saving space when you have multiple similar files.\n\n5. Storage: Chunks are bundled into \"xorbs\" and metadata is stored in \"MDB shards\" for efficient retrieval.\n\nWhen downloading from HuggingFace, the library queries the CAS (content-addressable storage) API to find which chunks are needed, fetches them (optionally in parallel using a thread pool), decompresses, and reconstructs the original file.\n\n### Performance\n\nThe parallel fetching implementation uses a thread pool to simultaneously:\n- Download chunks via HTTP\n- Decompress chunks\n- Compute BLAKE3 hashes\n\nThis provides significant speedup for large models, especially on multi-core systems with good network bandwidth.\n\n## Protocol compliance\n\nThis implementation follows the official XET protocol specification exactly.\n\nAll constants, algorithms, and formats match the reference Rust implementation byte-for-byte. The test suite includes cross-verification tests to ensure continued compatibility.\n\n## Getting a HuggingFace token\n\n1. Go to https://huggingface.co/settings/tokens\n2. Create a new token with \"Read access to contents of all public gated repos you can access\"\n3. Copy the token and set it as `HF_TOKEN` environment variable\n\n## Links\n\n- [XET Protocol Draft Specification](https://jedisct1.github.io/draft-denis-xet/draft-denis-xet.html)\n- [XET Protocol Documentation](https://huggingface.co/docs/xet/index)\n",
  "owner_avatar_url": "https://avatars.githubusercontent.com/u/124872?v=4",
  "releases": [
    {
      "tag_name": "0.1.0",
      "name": "0.1.0",
      "body": "",
      "prerelease": false,
      "published_at": "2025-12-18T08:33:35Z",
      "html_url": "https://github.com/jedisct1/zig-xet/releases/tag/0.1.0",
      "assets": []
    }
  ],
  "owner_bio": "Get my public keys here: https://sk.tl/7CPRo8kn",
  "owner_company": null,
  "owner_location": "Antibes, France",
  "owner_blog": "https://primulinus.com",
  "owner_twitter_username": "jedisct1",
  "owner_followers": 4133,
  "owner_following": 194,
  "owner_created_at": "2009-09-09T10:20:57Z",
  "license": "MIT",
  "category": "library"
}