{
  "name": "zig-lwbc32",
  "owner": "jedisct1",
  "repo": "zig-lwbc32",
  "description": "Lightweight 32-bit Block Cipher Library.",
  "type": "package",
  "topics": [
    "blockcipher",
    "lightweight",
    "simeck",
    "simon",
    "speck",
    "simeck32",
    "simon32",
    "speck32",
    "zig-package"
  ],
  "stars": 4,
  "forks": 0,
  "watchers": 1,
  "updated_at": "2026-02-10T23:31:19Z",
  "dependencies": [
    {
      "name": "example",
      "url": "https://example.com/foo.tar.gz",
      "hash": "..."
    }
  ],
  "minimum_zig_version": "0.16.0-dev.51+12a58087a",
  "readme": "# Lightweight Block Cipher Library\n\nA Zig implementation of lightweight block ciphers from the SPECK/SIMON family. These ciphers are designed for use in resource-constrained environments and offer high performance in software implementations.\n\n## Ciphers Overview\n\n| Cipher       | Block Size | Key Size | Rounds | Word Size | Structure                     |\n| ------------ | ---------- | -------- | ------ | --------- | ----------------------------- |\n| SPECK32/64   | 32 bits    | 64 bits  | 22     | 16-bit    | ARX (Addition, Rotation, XOR) |\n| SPECK48/96   | 48 bits    | 96 bits  | 23     | 24-bit    | ARX (Addition, Rotation, XOR) |\n| SPECK64/128  | 64 bits    | 128 bits | 27     | 32-bit    | ARX (Addition, Rotation, XOR) |\n| SPECK96/144  | 96 bits    | 144 bits | 29     | 48-bit    | ARX (Addition, Rotation, XOR) |\n| SIMON32/64   | 32 bits    | 64 bits  | 32     | 16-bit    | Balanced Feistel              |\n| SIMON48/96   | 48 bits    | 96 bits  | 36     | 24-bit    | Balanced Feistel              |\n| SIMON64/128  | 64 bits    | 128 bits | 44     | 32-bit    | Balanced Feistel              |\n| SIMON96/144  | 96 bits    | 144 bits | 54     | 48-bit    | Balanced Feistel              |\n| SIMECK32/64  | 32 bits    | 64 bits  | 32     | 16-bit    | Feistel (hybrid)              |\n| SIMECK64/128 | 64 bits    | 128 bits | 44     | 32-bit    | Feistel (hybrid)              |\n\n### Whitened Variants\n\nAll ciphers have whitened variants with extended keys that add XOR whitening before and after encryption:\n\n| Cipher           | Block Size | Key Size | Structure                        |\n| ---------------- | ---------- | -------- | -------------------------------- |\n| Speck32Whitened  | 32 bits    | 128 bits | 64-bit cipher + 32-bit pre/post  |\n| Speck48Whitened  | 48 bits    | 192 bits | 96-bit cipher + 48-bit pre/post  |\n| Speck64Whitened  | 64 bits    | 256 bits | 128-bit cipher + 64-bit pre/post |\n| Speck96Whitened  | 96 bits    | 336 bits | 144-bit cipher + 96-bit pre/post |\n| Simon32Whitened  | 32 bits    | 128 bits | 64-bit cipher + 32-bit pre/post  |\n| Simon48Whitened  | 48 bits    | 192 bits | 96-bit cipher + 48-bit pre/post  |\n| Simon64Whitened  | 64 bits    | 256 bits | 128-bit cipher + 64-bit pre/post |\n| Simon96Whitened  | 96 bits    | 336 bits | 144-bit cipher + 96-bit pre/post |\n| Simeck32Whitened | 32 bits    | 128 bits | 64-bit cipher + 32-bit pre/post  |\n| Simeck64Whitened | 64 bits    | 256 bits | 128-bit cipher + 64-bit pre/post |\n\n## Building and Running\n\nTo build and run the demo application:\n\n```bash\nzig build run -Doptimize=ReleaseFast\n```\n\nThis will display encryption/decryption examples for all ciphers along with benchmark results.\n\n## Running Tests\n\nTo run all tests:\n\n```bash\nzig build test\n```\n\n## Usage\n\nAdd `lwbc32` as a dependency in your `build.zig.zon`, then:\n\n```zig\nconst lwbc32 = @import(\"lwbc32\");\n\n// Standard ciphers\nconst speck32 = lwbc32.Speck32.init(.{ 0x0100, 0x0908, 0x1110, 0x1918 });\nconst ciphertext = speck32.encrypt(.{ 0x6574, 0x694c });\nconst plaintext = speck32.decrypt(ciphertext);\n\n// 48-bit block cipher (24-bit words)\nconst speck48 = lwbc32.Speck48.init(.{ 0x020100, 0x0a0908, 0x121110, 0x1a1918 });\nconst ct48 = speck48.encrypt(.{ 0x6d2073, 0x696874 });\n\n// 64-bit block ciphers\nconst simon64 = lwbc32.Simon64.init(.{ 0x03020100, 0x0b0a0908, 0x13121110, 0x1b1a1918 });\n\n// 96-bit block ciphers (48-bit words, 3-word keys)\nconst speck96 = lwbc32.Speck96.init(.{ 0x050403020100, 0x0d0c0b0a0908, 0x151413121110 });\nconst ct96 = speck96.encrypt(.{ 0x656d6974206e, 0x69202c726576 });\n\n// Whitened variants (extended keys)\nconst speck32w = lwbc32.Speck32Whitened.init(.{\n    0x0100, 0x0908, 0x1110, 0x1918,  // cipher key\n    0xdead, 0xbeef,                  // pre-whitening key\n    0xcafe, 0xbabe,                  // post-whitening key\n});\n\n// Byte-oriented interface\nconst ct_bytes = speck32.encryptBlock(.{ 0x74, 0x65, 0x4c, 0x69 });\nconst pt_bytes = speck32.decryptBlock(ct_bytes);\n\n// Key from byte array (all ciphers support this)\nconst speck48b = lwbc32.Speck48.fromBytes(.{\n    0x00, 0x01, 0x02, 0x08, 0x09, 0x0a, 0x10, 0x11, 0x12, 0x18, 0x19, 0x1a,\n});\n```\n\n## Performance\n\nBenchmark results on Apple M-series (10 million encryptions, ReleaseFast):\n\n| Cipher   | Time     | Ops/sec | Throughput |\n| -------- | -------- | ------- | ---------- |\n| SPECK32  | 258 ms   | 38.7M   | 1.24 Gbps  |\n| SPECK48  | 236 ms   | 42.5M   | 2.04 Gbps  |\n| SPECK64  | 194 ms   | 51.5M   | 3.29 Gbps  |\n| SPECK96  | 290 ms   | 34.5M   | 3.32 Gbps  |\n| SIMON32  | 464 ms   | 21.6M   | 0.69 Gbps  |\n| SIMON48  | 569 ms   | 17.6M   | 0.84 Gbps  |\n| SIMON64  | 427 ms   | 23.4M   | 1.50 Gbps  |\n| SIMON96  | 844 ms   | 11.9M   | 1.14 Gbps  |\n| SIMECK32 | 443 ms   | 22.6M   | 0.72 Gbps  |\n| SIMECK64 | 420 ms   | 23.7M   | 1.53 Gbps  |\n\nSPECK is faster due to fewer rounds and simpler ARX operations. Whitened variants have minimal overhead (~2-3%).\n\n## Security Notes\n\n**Important Security Considerations**:\n\n1. **32-bit block size vulnerability**: The 32-bit variants use small blocks, making them vulnerable to birthday attacks with just 2^16 blocks. They should only be used in extremely constrained environments.\n\n2. **48-bit block size**: SPECK48/96 and SIMON48/96 offer slightly better margins (birthday bound at 2^24 blocks) but are still limited for high-volume applications.\n\n3. **64-bit block size**: SPECK64/128 and SIMON64/128 provide better security margins (birthday bound at 2^32 blocks) and 128-bit key security against brute force.\n\n4. **96-bit block size**: SPECK96/144 and SIMON96/144 push the birthday bound to 2^48 blocks with 144-bit keys, offering a middle ground between lightweight and conventional ciphers.\n\n5. **Intended use**: These lightweight ciphers are intended for constrained environments where larger block sizes are not feasible.\n\nFor applications requiring strong security, consider using other authenticated encryption schemes.\n\n## References\n\n1. [NSA Lightweight Cryptography](https://www.nsa.gov/Research-and-Domain-Expertise/Research/Technical-Publications/Lightweight-Cryptography.cfm)\n2. [The SIMON and SPECK Families of Lightweight Block Ciphers](https://eprint.iacr.org/2013/404.pdf)\n3. [SIMECK: A Family of Lightweight Block Ciphers](https://eprint.iacr.org/2015/612.pdf)\n",
  "owner_avatar_url": "https://avatars.githubusercontent.com/u/124872?v=4",
  "releases": [],
  "owner_bio": "Get my public keys here: https://sk.tl/7CPRo8kn",
  "owner_company": null,
  "owner_location": "Antibes, France",
  "owner_blog": "https://00f.net",
  "owner_twitter_username": "jedisct1",
  "owner_followers": 4143,
  "owner_following": 195,
  "owner_created_at": "2009-09-09T10:20:57Z",
  "license": "MIT",
  "category": "library"
}