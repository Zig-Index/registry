{
  "name": "areion",
  "owner": "jedisct1",
  "repo": "areion",
  "description": "The AREION public crypto permutation, implemented in Zig.",
  "type": "package",
  "topics": [
    "aes",
    "hash",
    "permutation",
    "areion",
    "zig",
    "areion512-md",
    "zig-package"
  ],
  "stars": 6,
  "forks": 0,
  "watchers": 2,
  "updated_at": "2026-02-18T12:43:15Z",
  "minimum_zig_version": "0.15.1",
  "readme": "# Areion\n\nFast Zig implementation of the [Areion](https://eprint.iacr.org/2023/794.pdf) permutation family presented at CHES 2023. This library provides both Areion512 and Areion256 variants, optimized for speed particularly on small inputs.\n\n## Features\n\n- **Areion512**: 512-bit permutation with 32-byte input blocks and 32-byte hash output\n- **Areion256**: 256-bit permutation with 16-byte input blocks and 16-byte hash output\n- **AreionOCH**: Authenticated encryption (AEAD) using the OCH construction\n- **Areion256Opp / Areion512Opp**: Authenticated encryption using the Offset Public Permutation (OPP) construction\n- **Areion512Vec / Areion256Vec**: Vectorized permutations for parallel processing of multiple independent states\n- AES-based permutation using hardware acceleration when available\n- Merkle-Damgård construction with Davies-Meyer compression\n- Comprehensive test vectors included\n\n## Building\n\n```bash\n# Build the library (creates zig-out/lib/libareion.a)\nzig build\n\n# Build with optimizations\nzig build --release=fast    # Optimized for performance\nzig build --release=safe    # Optimized with safety checks\nzig build --release=small   # Optimized for size\n\n# Run tests\nzig build test\n```\n\n## Usage\n\nThis library provides a standard hash function interface compatible with other Zig crypto libraries:\n\n```zig\nconst std = @import(\"std\");\nconst areion = @import(\"areion\");\n\n// Areion512 hash function\nvar output512: [32]u8 = undefined;\nareion.Areion512.hash(\"your message here\", &output512, .{});\n\n// Areion256 hash function  \nvar output256: [16]u8 = undefined;\nareion.Areion256.hash(\"your message here\", &output256, .{});\n\n// Direct permutation usage (advanced)\nvar state512 = areion.Areion512{};\nstate512.absorb([_]u8{0x01} ** 32);  // Absorb 32-byte input\nstate512.permute();                   // Apply permutation\nconst squeezed = state512.squeeze();  // Extract 32-byte output\n\n// Authenticated encryption with AreionOCH\nconst key: [32]u8 = ...; // 256-bit key\nconst npub: [24]u8 = ...; // 192-bit public nonce\nconst nsec: [8]u8 = ...; // 64-bit secret nonce\nconst plaintext = \"secret message\";\nconst associated_data = \"metadata\";\n\nvar ciphertext: [plaintext.len + 8]u8 = undefined;\nvar tag: [32]u8 = undefined;\nareion.AreionOCH.encrypt(&ciphertext, &tag, plaintext, associated_data, npub, nsec, key);\n\n// Decryption\nvar decrypted: [plaintext.len]u8 = undefined;\nvar recovered_nsec: [8]u8 = undefined;\ntry areion.AreionOCH.decrypt(&decrypted, &recovered_nsec, &ciphertext, tag, associated_data, npub, key);\n```\n\n## API Reference\n\n### Areion512\n\n- `block_length`: 32 bytes (input block size)\n- `digest_length`: 32 bytes (output hash size)\n- `hash(input, output, options)`: Main hash function\n- `fromBytes(bytes)`: Create instance from 64-byte state\n- `toBytes()`: Serialize state to 64 bytes\n- `absorb(bytes)`: Absorb 32-byte input block\n- `squeeze()`: Extract 32-byte output\n- `permute()`: Apply 15-round permutation\n- `inversePermute()`: Apply the inverse permutation\n- `setRate(bytes)` / `setCapacity(bytes)` / `getCapacity()`: Direct state manipulation\n- `dm(message)`: Single-call Davies-Meyer compression of a 64-byte block\n- `prf(input, key)`: Truncated Even-Mansour PRF (64-byte key + 64-byte input → 32-byte output)\n- `encrypt(plaintext, key)`: Even-Mansour block cipher encryption (64-byte key, 64-byte block)\n- `decrypt(ciphertext, key)`: Even-Mansour block cipher decryption\n\n### Areion256\n\n- `block_length`: 16 bytes (input block size)\n- `digest_length`: 16 bytes (output hash size)\n- `hash(input, output, options)`: Main hash function\n- `fromBytes(bytes)`: Create instance from 32-byte state\n- `toBytes()`: Serialize state to 32 bytes\n- `absorb(bytes)`: Absorb 16-byte input block\n- `squeeze()`: Extract 16-byte output\n- `permute()`: Apply 10-round permutation\n- `inversePermute()`: Apply the inverse permutation\n- `setRate(bytes)` / `setCapacity(bytes)` / `getCapacity()`: Direct state manipulation\n- `dm(message)`: Single-call Davies-Meyer compression of a 32-byte block\n- `prf(input, key)`: Truncated Even-Mansour PRF (32-byte key + 32-byte input → 16-byte output)\n- `encrypt(plaintext, key)`: Even-Mansour block cipher encryption (32-byte key, 32-byte block)\n- `decrypt(ciphertext, key)`: Even-Mansour block cipher decryption\n\n### AreionOCH\n\nAuthenticated encryption with associated data (AEAD) based on the OCH construction (CCS 2025).\n\n- `key_length`: 32 bytes\n- `npub_length`: 24 bytes (public nonce)\n- `nsec_length`: 8 bytes (secret nonce, embedded in ciphertext)\n- `tag_length`: 32 bytes (authentication tag)\n- `encrypt(c, tag, m, ad, npub, nsec, key)`: Encrypt and authenticate\n- `decrypt(m, nsec, c, tag, ad, npub, key)`: Decrypt and verify (returns `AuthenticationError` on failure)\n\nSecurity properties:\n- 128-bit NAE (nonce-based authenticated encryption) security\n- 128-bit CMT (context commitment) security\n- 256-bit nonces with nonce privacy (secret nonce embedded in ciphertext)\n\n### Areion256Opp / Areion512Opp\n\nAuthenticated encryption using the Offset Public Permutation (OPP) construction.\n\n- `key_length`: 16 bytes\n- `nonce_length`: 16 bytes\n- `tag_length`: 16 bytes\n- `block_length`: 32 bytes (Areion256Opp) or 64 bytes (Areion512Opp)\n- `encrypt(key, nonce, ad, plaintext, ciphertext, tag)`: Encrypt and authenticate\n- `decrypt(key, nonce, ad, ciphertext, tag, plaintext)`: Decrypt and verify (Areion256Opp only)\n\nBoth provide a streaming interface via `init`, `updateAd`, `update`, and `finalize`.\n\n### Areion512Vec / Areion256Vec\n\nVectorized permutations for processing `count` independent states in parallel using SIMD. Created via `Areion512Vec(count)` or `Areion256Vec(count)`.\n\n- `fromBytes(bytes)` / `toBytes()`: Serialize/deserialize concatenated states\n- `xorBlocks(other)`: Element-wise XOR of two vectorized states\n- `permute()` / `inversePermute()`: Apply the permutation to all parallel states\n\n## Algorithm Details\n\n### State Structure\n- **Areion512**: 4 AES blocks (512 bits total)\n  - blocks[0-1]: Rate (32 bytes) for input absorption\n  - blocks[2-3]: Capacity (32 bytes) for internal state\n- **Areion256**: 2 AES blocks (256 bits total)\n  - blocks[0]: Rate (16 bytes) for input absorption\n  - blocks[1]: Capacity (16 bytes) for internal state\n\n### Padding Scheme\nStandard Merkle-Damgård padding:\n1. Append 0x80 byte\n2. Pad with zeros\n3. Append 32-bit big-endian bit length\n4. Handle multi-block padding when necessary\n\n## Performance\n\nThis implementation is optimized for:\n- Small input sizes (common in cryptographic applications)\n- Hardware AES acceleration when available\n- Low memory overhead\n- Cache-friendly memory access patterns\n\n## Papers and References\n\nThis implementation is based on:\n- **Areion**: [Areion: Highly-Efficient Permutations and Its Applications](https://eprint.iacr.org/2023/794.pdf) (CHES 2023)\n  - Authors: Clémence Bouvier, Pierre Briaud, Pyrros Chaidos, Léo Perrin, Robin Salen, Vesselin Velichkov, Danny Willems\n- **OCH**: OCH authenticated encryption mode (CCS 2025)\n- **OPP**: [Improved Masking for Tweakable Blockciphers with Applications to Authenticated Encryption](https://eprint.iacr.org/2015/999.pdf) (EUROCRYPT 2016) -- defines the OPP AEAD construction\n\nImplementation uses corrected test vectors from the updated Areion paper.\n",
  "owner_avatar_url": "https://avatars.githubusercontent.com/u/124872?v=4",
  "releases": [],
  "owner_bio": "Get my public keys here: https://sk.tl/7CPRo8kn",
  "owner_company": null,
  "owner_location": "Antibes, France",
  "owner_blog": "https://00f.net",
  "owner_twitter_username": "jedisct1",
  "owner_followers": 4157,
  "owner_following": 195,
  "owner_created_at": "2009-09-09T10:20:57Z",
  "license": "MIT",
  "category": "library"
}