{
  "name": "zig-common-access-token",
  "owner": "jedisct1",
  "repo": "zig-common-access-token",
  "description": "Zig implementation of Common Access Token (CTA-5007).",
  "type": "package",
  "topics": [
    "access",
    "cat",
    "common",
    "common-access-tokens",
    "cta",
    "token",
    "tokens",
    "zig",
    "zig-package",
    "please-use-better-authentication-mechanisms"
  ],
  "stars": 4,
  "forks": 0,
  "watchers": 1,
  "updated_at": "2026-01-06T19:25:42Z",
  "readme": "# Common Access Token (CAT) for Zig\n\nA Zig implementation of the Common Access Token (CAT) specification with HMAC signatures.\n\n## What is CAT?\n\nCommon Access Token (CAT) is a token format designed for authorization and authentication in distributed systems, particularly for media and content delivery applications. It provides a secure, compact, and efficient way to represent claims and authorization information between parties.\n\nCAT is built on established standards:\n- Based on [CBOR Web Token (CWT)](https://tools.ietf.org/html/rfc8392) format\n- Uses [CBOR Object Signing and Encryption (COSE)](https://tools.ietf.org/html/rfc8152) for cryptographic operations\n- Provides a binary alternative to JWT with smaller token sizes and more efficient processing\n\n## Overview\n\nThis library provides a complete implementation for generating and validating Common Access Tokens (CAT) using HMAC signatures. It is designed to be interoperable with other implementations like [node-cat](https://github.com/Eyevinn/node-cat) and [common-access-token](https://github.com/fastly/rust-cat).\n\nKey benefits of using CAT tokens:\n- Compact: Binary format results in smaller token sizes compared to text-based formats\n- Efficient: CBOR encoding/decoding is faster and requires less processing power\n- Secure: Built on established cryptographic standards\n- Extensible: Supports custom claims and extensions\n\n## Features\n\n- Token Operations:\n  - Generate CAT tokens with HMAC signatures (HS256)\n  - Validate CAT tokens with comprehensive security checks\n  - Support for token expiration and time-based validation\n\n- Claims Support:\n  - Standard CWT claims (issuer, subject, audience, expiration, etc.)\n  - CAT-specific claims (version, renewal, usage, data, authorization)\n  - Custom claim extension capability\n\n- CBOR Implementation:\n  - High-performance CBOR encoding/decoding\n  - Support for all CBOR data types\n  - Support for indefinite-length arrays, maps, and strings\n  - Support for floating-point numbers\n  - Support for tagged values\n\n- Error Handling:\n  - Comprehensive error types\n  - Detailed error messages\n  - Error context information\n  - Error recovery mechanisms\n\n- Integration:\n  - Interoperability with other CAT implementations\n  - Easy integration with Zig applications\n  - Comprehensive documentation and examples\n\n## Installation\n\nAdd this library to your `build.zig.zon` file:\n\n```zig\n.dependencies = .{\n    .zig_cat = .{\n        .url = \"https://github.com/yourusername/zig-cat/archive/refs/tags/v0.1.0.tar.gz\",\n        .hash = \"...\",\n    },\n},\n```\n\nThen in your `build.zig`:\n\n```zig\nconst zig_cat = b.dependency(\"zig_cat\", .{\n    .target = target,\n    .optimize = optimize,\n});\nexe.addModule(\"cat\", zig_cat.module(\"cat\"));\n```\n\n## Usage\n\n### Token Generation\n\nThis example demonstrates how to create a CAT token with standard claims:\n\n```zig\nconst std = @import(\"std\");\nconst cat = @import(\"cat\");\n\npub fn main() !void {\n    var gpa = std.heap.GeneralPurposeAllocator(.{}){};\n    defer _ = gpa.deinit();\n    const allocator = gpa.allocator();\n\n    // Create a key for token signing\n    const key_hex = \"403697de87af64611c1d32a05dab0fe1fcb715a86ab435f1ec99192d79569388\";\n    const key = try cat.util.hexToBytes(allocator, key_hex);\n    defer allocator.free(key);\n\n    // Create a map of keys\n    var keys = std.StringHashMap([]const u8).init(allocator);\n    defer keys.deinit();\n    try keys.put(\"Symmetric256\", key);\n\n    // Create CAT options\n    const cat_options = cat.CatOptions{\n        .keys = keys,\n        .expect_cwt_tag = true,\n    };\n\n    // Create a CAT instance\n    var cat_instance = cat.Cat.init(allocator, cat_options);\n    defer cat_instance.deinit();\n\n    // Create claims\n    var claims = cat.Claims.init(allocator);\n    defer claims.deinit();\n\n    try claims.setIssuer(\"example\");\n    try claims.setSubject(\"user123\");\n    try claims.setAudience(\"service\");\n\n    const now = cat.util.currentTimeSecs();\n    try claims.setExpiration(now + 120); // 2 minutes from now\n    try claims.setIssuedAt(now);\n\n    // Generate token\n    const token = try cat_instance.generate(claims, .{\n        .validation_type = cat.CatValidationType.Mac,\n        .alg = \"HS256\",\n        .kid = \"Symmetric256\",\n        .generate_cwt_id = true,\n    });\n    defer allocator.free(token);\n\n    std.debug.print(\"Generated token: {s}\\n\", .{token});\n}\n```\n\n### Token Validation\n\n```zig\nconst std = @import(\"std\");\nconst cat = @import(\"cat\");\n\npub fn main() !void {\n    var gpa = std.heap.GeneralPurposeAllocator(.{}){};\n    defer _ = gpa.deinit();\n    const allocator = gpa.allocator();\n\n    // The token to validate (e.g., from a client request)\n    const token = \"2D3RhEOhAQWhBExTeW1tZXRyaWMyNTZYS6YHWCA1YmJjNDI2NWVmYTAxOGI4YjU4Y2I5OTQyY2IwODFmMQFnZXhhbXBsZQQaaQpK1gYaaQpKXgJndXNlcjEyMwNnc2VydmljZVggNRE3wudeG0Fd-vJMZiLpNRO6WU9lrtByioSvzuAEi7U\";\n\n    // Create a key for token validation\n    const key_hex = \"403697de87af64611c1d32a05dab0fe1fcb715a86ab435f1ec99192d79569388\";\n    const key = try cat.util.hexToBytes(allocator, key_hex);\n    defer allocator.free(key);\n\n    // Create a map of keys\n    var keys = std.StringHashMap([]const u8).init(allocator);\n    defer keys.deinit();\n    try keys.put(\"Symmetric256\", key);\n\n    // Create CAT options\n    const cat_options = cat.CatOptions{\n        .keys = keys,\n        .expect_cwt_tag = true,\n    };\n\n    // Create a CAT instance\n    var cat_instance = cat.Cat.init(allocator, cat_options);\n    defer cat_instance.deinit();\n\n    // Validate the token\n    var claims = try cat_instance.validate(token, cat.CatValidationType.Mac, .{\n        .issuer = \"example\",\n        .audience = null,\n    });\n    defer claims.deinit();\n\n    std.debug.print(\"Token is valid!\\n\", .{});\n    if (claims.getIssuer()) |issuer| {\n        std.debug.print(\"Issuer: {s}\\n\", .{issuer});\n    }\n    if (claims.getSubject()) |subject| {\n        std.debug.print(\"Subject: {s}\\n\", .{subject});\n    }\n}\n```\n\n## Examples\n\nThe library includes several ready-to-use examples in the `examples/` directory:\n\n- generate.zig: Demonstrates basic token generation with standard claims\n- validate.zig: Shows how to validate tokens and extract claims\n- interop.zig: Tests interoperability with the NodeJS implementation (node-cat)\n- cat_claims.zig: Demonstrates using CAT-specific claims for advanced use cases\n- minimal.zig: Simple example showing basic base64 encoding utilities\n\nTo run an example:\n\n```bash\n# Generate a token\nzig build generate\n\n# Validate a token (replace <token> with an actual token)\nzig build validate -- <token>\n\n# Test interoperability with NodeJS implementation\nzig build interop [-- <token>]\n\n# Use CAT-specific claims\nzig build cat_claims\n\n# Run minimal example\nzig build minimal\n```\n\n## Security Considerations\n\nWhen using CAT tokens in your applications, keep these security best practices in mind:\n\n1. Key Management:\n   - Store signing keys securely\n   - Rotate keys periodically\n   - Use different keys for different environments\n\n2. Token Validation:\n   - Always validate tokens before trusting their contents\n   - Check expiration times\n   - Verify the issuer and audience claims\n\n3. Token Lifetime:\n   - Use short-lived tokens when possible\n   - For longer sessions, consider refresh token patterns\n\n4. Claims:\n   - Only include necessary information in tokens\n   - Be cautious with sensitive data in claims\n\n## Compatibility\n\nThis library is designed to be interoperable with other CAT implementations:\n\n- [node-cat](https://github.com/Eyevinn/node-cat): The NodeJS reference implementation\n- [common-access-token](https://github.com/fastly/rust-cat): The Rust implementation\n- Other implementations that follow the CAT specification\n\n## License\n\nThis project is licensed under the MIT License - see the LICENSE file for details.\n",
  "owner_avatar_url": "https://avatars.githubusercontent.com/u/124872?v=4",
  "releases": [],
  "owner_bio": "Get my public keys here: https://sk.tl/7CPRo8kn",
  "owner_company": null,
  "owner_location": "Antibes, France",
  "owner_blog": "https://00f.net",
  "owner_twitter_username": "jedisct1",
  "owner_followers": 4140,
  "owner_following": 195,
  "owner_created_at": "2009-09-09T10:20:57Z",
  "license": "MIT",
  "category": "library"
}