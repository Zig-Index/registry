{
  "name": "zig-opa-wasm",
  "owner": "burdzwastaken",
  "repo": "zig-opa-wasm",
  "description": "OPA policy evaluation for Zig with pluggable WASM backends",
  "type": "package",
  "topics": [
    "opa",
    "open-policy-agent",
    "wasm",
    "zig",
    "zig-package",
    "zig-program"
  ],
  "stars": 0,
  "forks": 0,
  "watchers": 0,
  "updated_at": "2025-12-28T10:18:08Z",
  "dependencies": [
    {
      "name": "wasmer_zig_api",
      "url": "https://github.com/burdzwastaken/wasmer-zig-api/archive/refs/heads/host-imports.tar.gz",
      "hash": "wasmer_zig_api-0.3.0-E2pGyl2uAABds7r5Nq65yHPuh19_Vrj5B7koSMBQPs7Y"
    },
    {
      "name": "mvzr",
      "url": "https://github.com/mnemnion/mvzr/archive/refs/tags/v0.3.7.tar.gz",
      "hash": "mvzr-0.3.7-ZSOky5FtAQB2VrFQPNbXHQCFJxWTMAYEK7ljYEaMR6jt"
    },
    {
      "name": "zig_yaml",
      "url": "https://github.com/kubkon/zig-yaml/archive/a6c2cd8760bf45c49b17a3f6259c4dfe3ded528e.tar.gz",
      "hash": "zig_yaml-0.2.0-C1161pmrAgDnipDTh_4v4RQD27XN5GNaVlzzvlXf1jfW"
    },
    {
      "name": "zul",
      "url": "https://github.com/karlseguin/zul/archive/refs/heads/master.tar.gz",
      "hash": "zul-0.0.0-1oDot9yRBwDA_ovd6GC1M_ViW3LarywMaGrH6vcuEjqv"
    },
    {
      "name": "zig_humanize",
      "url": "https://github.com/burdzwastaken/zig-humanize/archive/refs/tags/v0.0.5.tar.gz",
      "hash": "humanize-0.0.5-xH2j9oHcAABixEpQnxZAi_btBp70H8-8OwkuUVM_XJ4e"
    }
  ],
  "minimum_zig_version": "0.15.2",
  "readme": "# zig-opa-wasm\n\n[![Zig](https://img.shields.io/badge/Zig-â‰¥0.15.2-color?logo=zig&color=%23f3ab20)](https://ziglang.org/download/)\n[![Release](https://img.shields.io/github/v/release/burdzwastaken/zig-opa-wasm)](https://github.com/burdzwastaken/zig-opa-wasm/releases)\n[![CI](https://img.shields.io/github/actions/workflow/status/burdzwastaken/zig-opa-wasm/ci.yml?branch=master)](https://github.com/burdzwastaken/zig-opa-wasm/actions)\n\nA Zig library to use OPA policies compiled to WASM.\n\n## Installation\n\nAdd to your `build.zig.zon`:\n\n```zig\n.dependencies = .{\n    .zig_opa_wasm = .{\n        .url = \"git+https://github.com/burdzwastaken/zig-opa-wasm#v0.0.1\",\n        .hash = \"...\",\n    },\n},\n```\n\nThen in `build.zig`:\n\n```zig\nconst opa = b.dependency(\"zig_opa_wasm\", .{\n    .target = target,\n    .optimize = optimize,\n});\nexe.root_module.addImport(\"opa\", opa.module(\"opa\"));\n```\n\n## CLI\n\n```bash\nzig build\n\n# evaluate a policy\nzig-out/bin/opa-zig eval -m policy.wasm -e \"example/allow\" -i '{\"user\":\"admin\"}'\n\n# evaluate with data\nzig-out/bin/opa-zig eval -m policy.wasm -e \"authz/allow\" -d '{\"roles\":[\"admin\"]}' -i '{\"user\":\"alice\"}'\n\n# load from OPA bundle\nzig-out/bin/opa-zig eval -m bundle.tar.gz -e \"main/decision\" -i '{\"action\":\"read\"}'\n\n# inspect a WASM module\nzig-out/bin/opa-zig info policy.wasm\n\n# benchmark evaluation\nzig-out/bin/opa-zig bench -m policy.wasm -e \"example/allow\" -i '{}' -n 10000\n```\n\n## API\n\n### Basic Evaluation\n\n```zig\nconst opa = @import(\"opa\");\n\nvar wasm_backend = try opa.WasmerBackend.init(allocator);\ndefer wasm_backend.deinit();\n\nvar be = wasm_backend.asBackend();\nvar policy = try opa.Policy.load(allocator, &be, wasm_bytes);\ndefer policy.deinit();\n\nvar instance = try opa.Instance.create(allocator, &policy);\ndefer instance.deinit();\n\nconst result = try instance.evaluate(\"example/allow\", \"{\\\"user\\\":\\\"admin\\\"}\");\ndefer allocator.free(result);\n```\n\n### With Data Document\n\n```zig\nvar instance = try opa.Instance.create(allocator, &policy);\ndefer instance.deinit();\n\ntry instance.setData(\"{\\\"roles\\\":{\\\"admin\\\":[\\\"read\\\",\\\"write\\\"]}}\");\n\nconst result = try instance.evaluate(\"authz/allow\", \"{\\\"user\\\":\\\"alice\\\",\\\"role\\\":\\\"admin\\\"}\");\ndefer allocator.free(result);\n```\n\n### Typed Evaluation\n\n```zig\nconst Decision = struct { allow: bool };\n\nconst decision = try instance.evaluateTyped(Decision, \"authz/allow\", \"{\\\"user\\\":\\\"admin\\\"}\");\n```\n\n### Instance Pooling\n\n```zig\nvar pool = try opa.InstancePool.init(allocator, &policy, 4);\ndefer pool.deinit();\n\nconst inst = try pool.acquire();\ndefer pool.release(inst);\n\nconst result = try inst.evaluate(\"example/allow\", \"{}\");\ndefer allocator.free(result);\n```\n\n### Bundle Loading\n\n```zig\nvar bundle = try opa.Bundle.fromFile(allocator, \"policy.tar.gz\");\ndefer bundle.deinit();\n\nvar policy = try opa.Policy.load(allocator, &be, bundle.wasm);\ndefer policy.deinit();\n```\n\n### Policy Validation\n\n```zig\nvar policy = try opa.Policy.load(allocator, &be, wasm_bytes);\ndefer policy.deinit();\n\nvar result = try policy.validate(allocator);\ndefer result.deinit(allocator);\n\nif (!result.valid) {\n    for (result.unsupported_builtins) |name| {\n        std.debug.print(\"unsupported builtin: {s}\\n\", .{name});\n    }\n}\n```\n\n### Debug Logging\n\n```zig\nvar wasm_backend = try opa.WasmerBackend.init(allocator);\ndefer wasm_backend.deinit();\n\nwasm_backend.setLogLevel(.debug);\nwasm_backend.setLogCallback(struct {\n    fn log(level: opa.LogLevel, msg: []const u8) void {\n        std.debug.print(\"[{s}] {s}\\n\", .{@tagName(level), msg});\n    }\n}.log);\n```\n\n## Architecture\n\n### Pluggable Backend\n\nThe library uses an abstract backend interface allowing different WASM runtimes to be swapped without changing application code.\n\n**Current backends:**\n- `WasmerBackend` - [Wasmer](https://github.com/zig-wasm/wasmer-zig-api) runtime (default)\n\n## Supported Builtins\n\n85+ builtins implemented including:\n\n- **Strings**: `concat`, `contains`, `sprintf`, `split`, `trim`, `lower`, `upper`, etc.\n- **Numbers**: `abs`, `round`, `ceil`, `floor`, `numbers.range`\n- **Arrays**: `array.concat`, `array.slice`, `count`, `sort`\n- **Objects**: `object.get`, `object.keys`, `object.remove`, `object.union`\n- **Encoding**: `base64.encode/decode`, `hex.encode/decode`, `urlquery.encode/decode`\n- **Crypto**: `crypto.md5`, `crypto.sha1`, `crypto.sha256`\n- **Time**: `time.now_ns`, `time.parse_rfc3339_ns`, `time.date`, `time.diff`\n- **Regex**: `regex.match`, `regex.split`, `regex.find_n`\n- **Net**: `net.cidr_contains`, `net.cidr_intersects`\n- **Types**: `is_string`, `is_number`, `is_array`, `is_object`, `type_name`\n\n## License\n\nMIT\n",
  "owner_avatar_url": "https://avatars.githubusercontent.com/u/13855668?u=7423262c8d6a46bc9cce88be8bc2e190271db147&v=4",
  "releases": [
    {
      "tag_name": "v0.0.1",
      "name": "v0.0.1",
      "body": "**Full Changelog**: https://github.com/burdzwastaken/zig-opa-wasm/commits/v0.0.1",
      "prerelease": false,
      "published_at": "2025-12-28T07:46:28Z",
      "html_url": "https://github.com/burdzwastaken/zig-opa-wasm/releases/tag/v0.0.1",
      "assets": []
    }
  ],
  "owner_bio": "cloud janitor",
  "owner_company": "Ping",
  "owner_location": "The Internet",
  "owner_blog": "https://void.burdz.net",
  "owner_twitter_username": "burdzwastaken",
  "owner_followers": 27,
  "owner_following": 12,
  "owner_created_at": "2015-08-18T17:25:49Z",
  "license": "MIT",
  "category": "library"
}