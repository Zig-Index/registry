{
  "name": "zig_pkg_tool",
  "owner": "dasimmet",
  "repo": "zig_pkg_tool",
  "description": "a command line tool to work with build.zig dependencies and build graphs",
  "type": "package",
  "topics": [
    "zig",
    "zig-package"
  ],
  "stars": 4,
  "forks": 0,
  "watchers": 1,
  "updated_at": "2025-12-10T01:35:51Z",
  "dependencies": [
    {
      "name": "known_folders",
      "url": "git+https://github.com/ziglibs/known-folders.git#92defaee76b07487769ca352fd0ba95bc8b42a2f",
      "hash": "known_folders-0.0.0-Fy-PJkfRAAAVdptXWXBspIIC7EkVgLgWozU5zIk5Zgcy"
    }
  ],
  "minimum_zig_version": "0.15.2",
  "readme": "# Zig Package tool\n\na command line tool to work with `build.zig` dependencies and build graphs.\n\nIt embeds custom build runners to retrieve build graph information,\nused to backup dependencies, output a graphviz `dot` file etc.\n\nThe repo vendors zig's `build-runner.zig` with an inserted hook\nto serialize the `std.Build` struct to `zon` and send it from the subpocess stdout\nback to `zigpkg`.\nThen that information is used to perform operations based on the build graph.\n\nIt is compatible and requires with `zig >= 0.14.0` at runtime, when zig master\nstarts making changes to the build runner the vendored runner needs to be versioned\ninside this tool.\n\n## Usage\n\n```\n> zig build\n> ./zig-out/bin/zigpkg --help\n# or:\n> zig build zigpkg -- --help\nusage: zigpkg <subcommand> [--help]\n\na multicall too to work with zig's build graphs\n\navailable subcommands:\n  dot     rerun \"zig build\" and output a graphviz \".dot\" file of build steps based on args\n  dotall  rerun \"zig build\" and output a graphviz \".dot\" file of all build steps\n  dothtml \"dotall\", but output html for vis.js instead of \".dit\"\n  zon     rerun \"zig build\" with a custom build runner and output the build graph as .zon to stdout\n  json    same as \"zon\" but output json\n  deppkg  more subcommands for creating and working with \"deppkg.tar.gz\" files. storing all\n          stores all dependencies of a directory containing build.zig.zon in a .tar.gz archive\n\nenvironment variables:\n\n  ZIG: path to the zig compiler to invoke in subprocesses.\n       defaults to \"zig\" in the PATH.\n```\n\n## Dependency packages\n\nThe \"deppkg create\" subcommand generates a single archive containing all dependencies\nzig fetches for same arguments you would provide to \"zig build\".\n\nThe file can be verified with the \"deppkg extract\" subcommand, which repacks the\nindividual dependencies into temporary tar archives, loads them back into zigs\npackage cache with \"zig fetch\", and compares the hash generated by zig with the\narchive.\n\nSo when releasing a zig project with dependencies, you can include the deppkg\narchive as a complete source distribution that is buildable even when upstream\ndependencies become unavailable for whatever reason.\n\nBe aware that not all lazy dependencies may be fetched depending on the provided\narguments (and even the \"native target\" if some host build steps switch out dependencies\nbased on it).\nThis means the user is to provide build options that will fetch all dependencies\nhe expects to be in the package.\n\nThis tool does use the exact same filter logic as zig's filter on the `paths`\nfield of `build.zig.zon`, but for packages without a `build.zig.zon` it uses\na hard coded list of paths the exclude when packaging:\n\n```zig\npub const default_ignores: []const []const u8 = &.{\n    \"zig-cache/\",\n    \".zig-cache/\",\n    \"zig-out/\",\n    \".git/\",\n    \".svn/\",\n    \".venv/\",\n    \"_venv/\",\n    \".spin/\",\n};\n```\n\n## Graphviz dependency graph\n\nthis executes `zig build` with a custom build runner (including potiential additional arguments),\nto convert the `Build.Step` graph to basic graphviz `dot` code.\nthat can be easily be converted to the svg form.\nFor now, generated dot strings are not escaped and might break.\n\nSince the build graph is dependent on the original invocation of `zig build`,\nintegration into the build system is not easy. It's easier to build `zigpkg`\nmanually, and invoke `zigpkg dot <build_root> [zig build ards]` with the same arguments\nas `zig build`.\n\n```bash\n# cli\n./zig-out/bin/zigpkg dot . install | dot -Tsvg > graph.svg\n```\n\n![Build Graph](graph.svg?sanitize=true)\n\n```zig\n// build.zig usage\n// - the disadvantage here is, `dotGraphStep` basically reruns `zig build`,\n//   and passes the extra arguments down, but does not know about the original arguments.\n// - svgGraph is a system \"dot\" command\nconst zig_pkg_tool = @import(\"pkg_tool\");\nconst svggraph = zig_pkg_tool.svgGraph(b, zig_pkg_tool.dotGraphStep(b, &.{\n    \"install\", // extra args zig build, e.g. targets\n    \"dot\",\n    \"test\",\n    \"run\",\n}).captureStdOut());\nb.step(\"dot\", \"install graph.svg\").dependOn(&b.addInstallFile(\n    svggraph,\n    \"graph.svg\",\n).step);\n```\n\n",
  "owner_avatar_url": "https://avatars.githubusercontent.com/u/2773256?u=609e5b7eac1f972a0854a240741c5c8deca85518&v=4",
  "releases": [],
  "owner_bio": "@ziglang enthusiast",
  "owner_company": "ANNAX GmbH",
  "owner_location": "Munich, Germany",
  "owner_blog": null,
  "owner_twitter_username": null,
  "owner_followers": 7,
  "owner_following": 4,
  "owner_created_at": "2012-11-11T19:52:46Z",
  "license": "MIT",
  "category": "library"
}